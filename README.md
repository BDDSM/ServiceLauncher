# Запускатор служб

 [![License: Unlicense](https://img.shields.io/badge/license-Unlicense-blue.svg)](http://unlicense.org/)

Скрипт на PowerShell для пакетного запуска или остановки заранее определенных служб Microsoft Windows. 

## Как пользоваться

Введите в Services.txt список служб, которые нужно запускать или останавливать с помощью скрипта. По одной на строку. Можно использовать шаблоны, понятные командлету Get-Service (подробности — в [документации](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-service?view=powershell-7) к языку).

Собственно, это всё. Вызовите Launcher.ps1 с параметром start, чтобы запустить службы:

`.\Launcher.ps1 -start`

Используйте параметр stop, чтобы остановить их:

`.\Launcher.ps1 -stop`

Если параметры не указаны, скрипт сам решит, запускать или останавливать службы. Для этого он определит статус первой службы в списке: если она работает — все службы из списка будут остановлены, если выключена — скрипт попытается их запустить.

Кроме самого запускатора, есть ещё один скрипт — Informer.ps1. Он тоже работает с первой службой из списка: проверяет её статус, а потом сообщает — работает она или нет. Удобно, если вы вызываете Launcher.ps1 без параметров и не уверены, нужно ли это делать. Для вывода информации Informer.ps1 использует стандартное всплывающее сообщение Windows (рядом с панелью уведомлений).

## Возможные проблемы

### Скрипту нужны админские права?

Скрипту Launcher.ps1 — да. Если выполнить его без прав администратора — он потребует их и, получив, перезапустит сам себя.

Для Informer.ps1 права администратора не нужны.

### Хочу расширить логику запуска и остановки. Куда смотреть?

В самый конец Launcher.ps1 — там есть блок, начинающийся с `If ($start) {`. В первую ветку добавьте логику для запуска, во вторую — для остановки.

Например, у меня дополнительно вызываются `IISRESET /start` и `IISRESET /stop`.
